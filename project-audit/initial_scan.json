{
    "scan_timestamp": "2025-10-02T00:00:00Z",
    "project_name": "ghostvault",
    "statistics": {
        "total_java_files": 111,
        "main_source_files": 78,
        "test_files": 33,
        "packages": 12
    },
    "targeted_security_files": {
        "crypto_manager": {
            "path": "src/main/java/com/ghostvault/security/CryptoManager.java",
            "current_algorithm": "AES/CBC/PKCS5Padding",
            "current_kdf": "PBKDF2WithHmacSHA256",
            "iterations": 100000,
            "issues": [
                "Uses AES-CBC with separate HMAC instead of AEAD (AES-GCM)",
                "Vulnerable to padding oracle attacks",
                "Manual HMAC implementation error-prone"
            ],
            "action_required": "Replace with AES-GCM AEAD"
        },
        "password_manager": {
            "path": "src/main/java/com/ghostvault/security/PasswordManager.java",
            "current_kdf": "PBKDF2WithHmacSHA256",
            "iterations": 100000,
            "issues": [
                "PBKDF2 is weaker than Argon2id for password hashing",
                "No KDF parameter storage in metadata",
                "Password handling uses String instead of char[] in some places",
                "Triple password detection timing may leak information"
            ],
            "action_required": "Implement Argon2id with fallback, improve timing safety"
        },
        "panic_mode_executor": {
            "path": "src/main/java/com/ghostvault/security/PanicModeExecutor.java",
            "issues": [
                "Physical overwrite-first approach (ineffective on SSDs)",
                "Should prioritize cryptographic erasure (key destruction)",
                "No dry-run mode for testing"
            ],
            "action_required": "Implement crypto-erasure-first with dry-run support"
        },
        "secure_deletion": {
            "path": "src/main/java/com/ghostvault/security/SecureDeletion.java",
            "issues": [
                "Multi-pass overwrite ineffective on modern SSDs/journaling filesystems",
                "Should be secondary to cryptographic erasure"
            ],
            "action_required": "Document limitations, make secondary to key destruction"
        }
    },
    "ui_files": {
        "login_controller": {
            "path": "src/main/java/com/ghostvault/ui/LoginController.java",
            "issues": [
                "May not implement single-textbox triple-password flow",
                "Timing differences between password types may be observable",
                "Need uniform UI response for all password types"
            ],
            "action_required": "Implement stealthy single-textbox with timing parity"
        }
    },
    "metadata_files": {
        "metadata_manager": {
            "path": "src/main/java/com/ghostvault/core/MetadataManager.java",
            "issues": [
                "May not store KDF parameters",
                "Need to add Argon2 parameter storage"
            ],
            "action_required": "Add KDF parameter storage and retrieval"
        }
    },
    "test_files": {
        "crypto_manager_test": {
            "path": "src/test/java/com/ghostvault/security/CryptoManagerTest.java",
            "action_required": "Add AEAD round-trip and tamper detection tests"
        },
        "panic_mode_test": {
            "path": "src/test/java/com/ghostvault/security/PanicModeExecutorTest.java",
            "action_required": "Add dry-run tests with temp directories"
        }
    },
    "dead_code_candidates": [
        "Unused imports across multiple files",
        "Deprecated methods in PasswordManager",
        "Potentially unused UI components"
    ],
    "security_priorities": [
        "1. Replace AES-CBC+HMAC with AES-GCM AEAD",
        "2. Implement Argon2id KDF with parameter storage",
        "3. Fix triple-password timing side-channels",
        "4. Implement cryptographic-erasure-first panic mode",
        "5. Add comprehensive tests for all security features"
    ],
    "compilation_status": "Unknown - needs verification",
    "next_steps": [
        "Create new branch: fix/triple-password-hardening",
        "Implement AEAD CryptoManager",
        "Implement Argon2id KDF utilities",
        "Update PasswordManager with KEK wrapping",
        "Update PanicModeExecutor with crypto-erasure",
        "Update LoginController for stealthy UX",
        "Add comprehensive tests",
        "Run static analysis",
        "Generate final report"
    ]
}